{% extends "base.html" %} 
{% block css %}
    <link rel="stylesheet" href="/static/css/playsudokustyles.css"/>
{% endblock %}
{% block title %} 
Play Sudoku
{% endblock %} 
{% block content %} 
<body>
<div id="whitescreen"><p id="dots">Generating Sudoku...</p>
    <img id="whitescreengrid" src="/static/grid.png">
    <img id="n1"class="numberimg" src="/static/1blue.jpg">
    <img id="n2"class="numberimg" src="/static/2blue.jpg">
    <img id="n3"class="numberimg" src="/static/3blue.jpg">
    <img id="n4"class="numberimg" src="/static/4blue.jpg">
    <img id="n5"class="numberimg" src="/static/5blue.jpg">
    <img id="n6"class="numberimg" src="/static/6blue.jpg">
    <img id="n7"class="numberimg" src="/static/7blue.jpg">
    <img id="n8"class="numberimg" src="/static/8blue.jpg">
    <img id="n9"class="numberimg" src="/static/9blue.jpg">  
</div>
<div id="finishscreen"><div style="margin:30px;text-align:center;"><p>Sudoku Complete!</p></div>
    <div id="finishdifs">
        <div style="margin:30px auto;text-align:center;font-size:1.25em;display:flex;gap:5px;justify-content:center"><b>New Puzzle:</b></div>
        <a class="diflink"href='/playsudoku/easy' onclick="whiteScreen();finishScreen()" name="easy" method="get" z-index=1>Easy</a>
        <a class="diflink"href='/playsudoku/medium'onclick="whiteScreen();finishScreen()" name="medium" method="get" z-index=1>Medium</a>
        <a class="diflink"href='/playsudoku/hard'onclick="whiteScreen();finishScreen()" name="hard" method="get" >Hard</a>
    </div>
</div>
<div class="contentcontainer">
    <div id="title" style="text-align:center"><b>Play Sudoku</b></div>
<div id="difs">
    <div style="font-size:1.25em;display:flex;gap:5px;justify-content:center"><b>New Puzzle:</b></div>
    <a id="easy"class="diflink"href='/playsudoku/easy' onclick="whiteScreen()" name="easy" method="get" z-index=1>Easy</a>
    <a id="medium"class="diflink"href='/playsudoku/medium'onclick="whiteScreen()" name="medium" method="get" z-index=1>Medium</a>
    <a id="hard"class="diflink"href='/playsudoku/hard'onclick="whiteScreen()" name="hard" method="get" >Hard</a>
</div>
<div id="sudokucontainer">
<div id="nums" style="grid-row:1/2;grid-column:2/3;">
                <b>1</b>
                <b>2</b>
                <b>3</b>
                <b>4</b>
                <b>5</b>
                <b>6</b>
                <b>7</b>
                <b>8</b>
                <b>9</b>
                    </div>
                    
                    <div id="lets" style="grid-row:2/3;grid-column:1/2;">
                    <div style="width:100%"><b>A</b></div> 
                    <div style="width:100%"><b>B</b></div> 
                    <div style="width:100%"><b>C</b></div> 
                    <div style="width:100%"><b>D</b></div> 
                    <div style="width:100%"><b>E</b></div> 
                    <div style="width:100%"><b>F</b></div> 
                    <div style="width:100%"><b>G</b></div> 
                    <div style="width:100%"><b>H</b></div> 
                    <div style="width:100%"><b>I</b></div> 
                    </div>
                    <form style="grid-row:2/3;grid-column:2/3"action="/play/onestep" method="post">
                        <div id="sudoku">
                        <input class="searchbar" type="input" id="A1" name="A1" autocomplete="off"/>
                        <input class="searchbar" type="input" id="A2" name="A2" autocomplete="off"/>
                        <input class="searchbar" type="input" id="A3"style="border-right:blue 0.25vw solid" name="A3" autocomplete="off"/>
                        <input class="searchbar" type="input" id="A4" style="border-left:blue 0.25vw solid"name="A4" autocomplete="off"/>
                        <input class="searchbar" type="input" id="A5" name="A5" autocomplete="off"/>
                        <input class="searchbar" type="input" id="A6" style="border-right:blue 0.25vw solid"name="A6" autocomplete="off"/>
                        <input class="searchbar" id="A7"  type="input" style="border-left:blue 0.25vw solid"name="A7" autocomplete="off"/>
                        <input class="searchbar" id="A8"  type="input" name="A8" autocomplete="off"/>
                        <input class="searchbar"id="A9" type="input" name="A9" autocomplete="off"/>
                        <input class="searchbar"id="B1" type="input" name="B1" autocomplete="off"/>
                        <input class="searchbar"id="B2" type="input" name="B2" autocomplete="off"/>
                        <input class="searchbar"id="B3" type="input"  style="border-right:blue 0.25vw solid"name="B3" autocomplete="off"/>
                        <input class="searchbar"id="B4" type="input" name="B4"style="border-left:blue 0.25vw solid" autocomplete="off"/>
                        <input class="searchbar"id="B5" type="input" name="B5" autocomplete="off"/>
                        <input class="searchbar"id="B6"  type="input" style="border-right:blue 0.25vw solid" name="B6" autocomplete="off"/>
                        <input class="searchbar" id="B7" type="input" name="B7"style="border-left:blue 0.25vw solid" autocomplete="off"/>
                        <input class="searchbar"id="B8" type="input" name="B8" autocomplete="off"/>
                        <input class="searchbar"id="B9" type="input" name="B9" autocomplete="off"/>
                        <input class="searchbar"id="C1" style="border-bottom:blue 0.25vw solid" type="input" name="C1" autocomplete="off"/>
                        <input class="searchbar" id="C2"style="border-bottom:blue 0.25vw solid" type="input" name="C2" autocomplete="off"/>
                        <input class="searchbar"id="C3" style="border-bottom:blue 0.25vw solid;border-right:blue 0.25vw solid" type="input" name="C3" autocomplete="off"/>
                        <input class="searchbar"id="C4" style="border-bottom:blue 0.25vw solid;border-left:blue 0.25vw solid" type="input" name="C4" autocomplete="off"/>
                        <input class="searchbar"id="C5" style="border-bottom:blue 0.25vw solid" type="input" name="C5" autocomplete="off"/>
                        <input class="searchbar"id="C6" style="border-bottom:blue 0.25vw solid;border-right:blue 0.25vw solid"type="input" name="C6" autocomplete="off"/>
                        <input class="searchbar"id="C7" style="border-bottom:blue 0.25vw solid;border-left:blue 0.25vw solid" type="input" name="C7" autocomplete="off"/>
                        <input class="searchbar"id="C8" style="border-bottom:blue 0.25vw solid" type="input" name="C8" autocomplete="off"/>
                        <input class="searchbar"id="C9" style="border-bottom:blue 0.25vw solid" type="input" name="C9" autocomplete="off"/>
                        <input class="searchbar"id="D1" style="border-top:blue 0.25vw solid" type="input" name="D1" autocomplete="off"/>
                        <input class="searchbar"id="D2" style="border-top:blue 0.25vw solid"  type="input" name="D2" autocomplete="off"/>
                        <input class="searchbar"id="D3" style="border-top:blue 0.25vw solid;border-right:blue 0.25vw solid" type="input" name="D3" autocomplete="off"/>
                        <input class="searchbar"id="D4" style="border-top: blue 0.25vw solid;border-left:0.25vw blue solid" type="input" name="D4" autocomplete="off"/>
                        <input class="searchbar"id="D5" style="border-top:blue 0.25vw solid" type="input" name="D5" autocomplete="off"/>
                        <input class="searchbar" id="D6"style="border-top:blue 0.25vw solid; border-right:blue 0.25vw solid"type="input" name="D6" autocomplete="off"/>
                        <input class="searchbar" id="D7"style="border-top:blue 0.25vw solid;border-left:0.25vw blue solid" type="input" name="D7" autocomplete="off"/>
                        <input class="searchbar"id="D8" style="border-top:blue 0.25vw solid" type="input" name="D8" autocomplete="off"/>
                        <input class="searchbar" id="D9"style="border-top:blue 0.25vw solid"type="input" name="D9" autocomplete="off"/>
                        <input class="searchbar"id="E1"  type="input" name="E1" autocomplete="off"/>
                        <input class="searchbar"id="E2"  type="input" name="E2" autocomplete="off"/>
                        <input class="searchbar" id="E3"  style="border-right:blue 0.25vw solid"type="input" name="E3" autocomplete="off"/>
                        <input class="searchbar" id="E4" style="border-left:blue 0.25vw solid"type="input" name="E4" autocomplete="off"/>
                        <input class="searchbar" id="E5" type="input" name="E5" autocomplete="off"/>
                        <input class="searchbar" id="E6"  style="border-right:blue 0.25vw solid"type="input" name="E6" autocomplete="off"/>
                        <input class="searchbar" id="E7" style="border-left:blue 0.25vw solid"type="input" name="E7" autocomplete="off"/>
                        <input class="searchbar" id="E8"type="input" name="E8" autocomplete="off"/>
                        <input class="searchbar" id="E9" type="input" name="E9" autocomplete="off"/>
                        <input class="searchbar" id="F1"style="border-bottom:blue 0.25vw solid" type="input" name="F1" autocomplete="off"/>
                        <input class="searchbar" id="F2"style="border-bottom:blue 0.25vw solid" type="input" name="F2" autocomplete="off"/>
                        <input class="searchbar" id="F3" style="border-right:blue 0.25vw solid;border-bottom:blue 0.25vw solid" type="input" name="F3" autocomplete="off"/>
                        <input class="searchbar" id="F4"style="border-bottom:blue 0.25vw solid;border-left:blue 0.25vw solid" type="input" name="F4" autocomplete="off"/>
                        <input class="searchbar" id="F5"style="border-bottom:blue 0.25vw solid" type="input" name="F5" autocomplete="off"/>
                        <input class="searchbar" id="F6" style="border-right:blue 0.25vw solid;border-bottom:blue 0.25vw solid" type="input" name="F6" autocomplete="off"/>
                        <input class="searchbar" id="F7"style="border-bottom:blue 0.25vw solid;border-left:blue 0.25vw solid" type="input" name="F7" autocomplete="off"/>
                        <input class="searchbar" id="F8"style="border-bottom:blue 0.25vw solid" type="input" name="F8" autocomplete="off"/>
                        <input class="searchbar" id="F9"style="border-bottom:blue 0.25vw solid" type="input" name="F9" autocomplete="off"/>
                        <input class="searchbar" id="G1" style="border-top:0.25vw blue solid"type="input" name="G1" autocomplete="off"/>
                        <input class="searchbar" id="G2" style="border-top:0.25vw blue solid"type="input" name="G2" autocomplete="off"/>
                        <input class="searchbar" id="G3" style="border-top:0.25vw blue solid;border-right:blue 0.25vw solid"type="input" name="G3" autocomplete="off"/>
                        <input class="searchbar" id="G4" style="border-top:0.25vw blue solid;border-left:blue 0.25vw solid"type="input" name="G4" autocomplete="off"/>
                        <input class="searchbar" id="G5" style="border-top:0.25vw blue solid"type="input" name="G5" autocomplete="off"/>
                        <input class="searchbar" id="G6" style="border-top:0.25vw blue solid;border-right:blue 0.25vw solid"type="input" name="G6" autocomplete="off"/>
                        <input class="searchbar" id="G7" style="border-top:0.25vw blue solid;border-left:blue 0.25vw solid"type="input" name="G7" autocomplete="off"/>
                        <input class="searchbar" id="G8" style="border-top:0.25vw blue solid"type="input" name="G8" autocomplete="off"/>
                        <input class="searchbar" id="G9" style="border-top:0.25vw blue solid"type="input" name="G9" autocomplete="off"/>
                        <input class="searchbar" id="H1" type="input" name="H1" autocomplete="off"/>
                        <input class="searchbar" id="H2" type="input" name="H2" autocomplete="off"/>
                        <input class="searchbar" id="H3"  style="border-right:blue 0.25vw solid"type="input" name="H3" autocomplete="off"/>
                        <input class="searchbar" id="H4" style="border-left:blue 0.25vw solid"type="input" name="H4" autocomplete="off"/>
                        <input class="searchbar" id="H5" type="input" name="H5" autocomplete="off"/>
                        <input class="searchbar" id="H6"  style="border-right:blue 0.25vw solid"type="input" name="H6" autocomplete="off"/>
                        <input class="searchbar" id="H7"style="border-left:blue 0.25vw solid" type="input" name="H7" autocomplete="off"/>
                        <input class="searchbar" id="H8" type="input" name="H8" autocomplete="off"/>
                        <input class="searchbar" id="H9" type="input" name="H9" autocomplete="off"/>
                        <input class="searchbar"id="I1" type="input" name="I1" autocomplete="off"/>
                        <input class="searchbar"id="I2"   type="input" name="I2" autocomplete="off"/>
                        <input class="searchbar" id="I3" style="border-right:blue 0.25vw solid"type="input" name="I3" autocomplete="off"/>
                        <input class="searchbar" id="I4"style="border-left:blue 0.25vw solid"type="input" name="I4" autocomplete="off"/>
                        <input class="searchbar"id="I5"  type="input" name="I5" autocomplete="off"/>
                        <input class="searchbar" id="I6" style="border-right:blue 0.25vw solid" type="input" name="I6" autocomplete="off"/>
                        <input class="searchbar" id="I7" style="border-left:blue 0.25vw solid"type="input" name="I7" autocomplete="off"/>
                        <input class="searchbar" id="I8" type="input" name="I8" autocomplete="off"/>
                        <input class="searchbar" id="I9" type="input" name="I9" autocomplete="off"/>
                        </div>
                        </div>
        <div id="buttons" class="obj">
            <p style="text-align:center;width:100%;font-size:1.25em"><b>Solving Options:</b></p>
            <input class="psbutton" id="ca" type="button" value="Check Answers">
            <input class="psbutton" id="solve"  onclick="location.href='/play/solve'" type="button"method="post" value="Solve Completely"/>
            <button class="psbutton" id="onestep" type="submit" name="onestep" method="post">Next Step</button>
        </form>
            <input class="psbutton" id="clear" onclick="location.href='/play/clear'" type="button"method="post" value="Clear Puzzle"/>
        <form action="/play/solvecell" method="post">
            <input id="cell" name="cell" type ="text"method="post" value="Solve cell"/>
    </form>
    </div>
    {% if methods[0] != "no" %}
    <div class="obj" id="steps" >
        <div style="font-size:1.25em;width:100%;text-align:center;font-family:sans-serif;"><p><b>Steps (scroll down):</b></p></div>
        {% for x in range(methods|length)%}
        <div style="text-align:center;width:100%"><p><b>{{methods[x]}}</b></p></div>
        <div style="font-size:1.25em;text-align:center;width:100%;font-family:sans-serif;"><p><b>Explanation:</b></p></div><div style="text-align:center;width:100%"><p>{{explain[x]}}</p></div>
        {% endfor %}
    </div>
    <div class="obj" id="stepsnoexplain">
        <div style="font-size:1.25em;width:100%;text-align:center;font-family:sans-serif;"><p><b>Steps (scroll down):</b></p></div>
        {% for x in range(methods|length)%}
        <div style="text-align:center;width:100%"><p><b>{{methods[x]}}</b></p></div>
        {% endfor %}
    </div>
    {% endif %}
    <div class="obj" id="checkboxes" >
        <div style="font-size:1.25em;text-align:center;width:100%"><b>Features:</b></div>
    <div style="width:100%"><input type="checkbox" id="togglecandidates" name="candidate" value="Toggle Candidate">
    <label for="togglecandidates">Enable/disable notes (N)</label></div>
    <div style="width:100%"><input type="checkbox" id="autocheck" name="autocheck" value="Autocheck answers">
    <label for="autocheck">Auto-check answers (A)</label></div>
    <div style="width:100%"><input type="checkbox" id="darkmode" name="darkmode" value="Dark mode">
        <label for="darkmode">Enable/disable dark mode (D)</label></div>
    <div style="width:100%"><input type="checkbox" id="explain" name="candidate" value="Explanations">
        <label for="explain">Explanations for steps (E)</label></div>
    </div>
    <div id="rules">
    <div style="font-size:1.25em;text-align:center;width:100%"><b>Sudoku Rules:</b></div>
    <div style="width:100%"><b>1.</b> Each cell must be filled in with a number between 1 and 9.</div>
    <div style="width:100%"><b>2.</b> When the puzzle is complete, each row, column, and box must contain each number 1-9.</div>
    <div style="width:100%"><b>3.</b> A row, column, or box cannot contain the same number more than once.</div>
    </div>
    <div id="options">
        <div style="font-size:1.25em;text-align:center;width:100%"><b>Features Explained:</b></div>
            <div style="width:100%"><b><i>Notes:</i></b> When checked, you can input notes in small font.</div><div style="font-family:monospace;width:100%">Keyboard shortcut: N</div>
            <div style="width:100%"><b><i>Auto-check:</i></b> The solver will automatically check your inputs. Red means incorrect, blue means correct.</div><div style="font-family:monospace;width:100%">Keyboard shortcut: A</div>
            <div style="width:100%"><b><i>Dark mode:</i></b> Darkens the grid and background.</div><div style="font-family:monospace;width:100%">Keyboard shortcut: D</div>
            <div style="width:100%"><b><i>Explanations:</i></b> If you use the solver to finish the sudoku, in-depth explanations will be added to explain each step that the solver took.</div><div style="font-family:monospace;width:100%">Keyboard shortcut: E</div>
    </div>
    <div id="check">
        <div style="font-size:1.25em;text-align:center;width:100%"><b>Solving Options:</b></div>
        <div style="width:100%;padding:5px;font-size:1em"><b>Check answers:</b>
        Press enter or click the check answers button to check your answers. Correct numbers will appear in blue, and incorrect numbers will appear in red.</div>
        <div style="width:100%;padding: 5px;font-size:1em;"><b>Solve completely:</b>
       All unsolved cells will be filled in with the correct number. A step-by-step explanation of how to solve the sudoku will replace the sudoku rules box.</div>
        <div style="width:100%;padding:5px;font-size:1em;"><b>Next step:</b>
        The solver will fill in the next step of the puzzle if you are stuck.</div>
        <div style="width:100%;padding:5px;font-size:1em;"><b>Clear grid:</b>
            Resets the puzzle to its original numbers.</div>
        <div style="width:100%;padding:5px;font-size:1em;"><b>Solve cell:</b>
        Enter the coordinates of an unfilled cell (example: 'A1'). The solver will input the correct number into this cell.</div>
    </div>
</div>
        <script>
            var checkbox = document.getElementById("togglecandidates");
            var autocheck = document.getElementById("autocheck");
            var darkmode = document.getElementById("darkmode");
            var explains = document.getElementById("explain")
            var cells = document.getElementsByClassName('searchbar')
            var solvecell = document.getElementById('cell')
            const inputs = document.querySelectorAll("input[type='input']");
            var checkanswers = document.getElementById('ca')
            if(document.getElementById('steps') && window.innerWidth > 900){
                document.getElementById('steps').style.height = document.getElementById('rules').offsetHeight.toString() + 'px'
                document.getElementById('stepsnoexplain').style.height = document.getElementById('rules').offsetHeight.toString() + 'px'
                document.getElementById('rules').style.gridRow = '4/5'
                console.log('steps height limited')
            }
            if(document.getElementById('steps') && window.innerWidth < 900){
                document.getElementById('steps').style.height = document.getElementById('rules').offsetHeight.toString() + 'px'
                document.getElementById('stepsnoexplain').style.height = document.getElementById('rules').offsetHeight.toString() + 'px'
            }
            solvecell.addEventListener('click', function(){
                solvecell.value = "";
            })
            for(let i=0;i < 81; i++){
            cells[i].addEventListener('input', function(){
            if(autocheck.checked && !checkbox.checked){
                console.log(this.value)
                console.log(sol[currentInputIndex])
                if(this.value === sol[currentInputIndex].toString()){
                    console.log('equal')
                    this.style.color = 'blue'
                    this.readOnly = 'true'
                    bluesjs.push(currentInputIndex)
                } else {
                    console.log('not equal')
                    this.style.color = 'red'
                    redsjs.push(currentInputIndex)
                }
            }
            var done = true;
            for(let i=0; i < 81;i++){
            if(cells[i].value === "" || cells[i].style.color === 'red'){
                console.log('not finished')
                done = false;
            }
        }
            if(done === true){
                finishscreen.style.display = 'block'
            }
                })
            }
            checkanswers.addEventListener('click', function(){
                    event.preventDefault();
                    solvecell.value = "Solve cell";
                    for(let i=0; i < 81;i++){
                        if(!graysjs.includes(i)){
                            console.log('not in grays')
                            if(cells[i].value !== "" && cells[i].style.textAlign === 'center'){
                                console.log('nonzero value')
                                if(cells[i].value === sol[i].toString()){
                                    cells[i].style.color = 'blue';
                                    cells[i].readOnly = 'true';
                                    bluesjs.push(i)
                                } else {
                                    cells[i].style.color = 'red';
                                }
                            }
                    }
                }
                var done = true;
                for(let i=0; i < 81;i++){
                    if(cells[i].value === "" || cells[i].style.color === 'red'){
                        done = false;
                    }
                }
                if(done === true){
                    finishscreen.style.display = 'block'
                }
                    })
            explains.addEventListener('change', function(){
                if(this.checked) {
                    if(document.getElementById("stepsnoexplain")){
                    document.getElementById("stepsnoexplain").style.display = 'none'
                    }
                } else {
                    if(document.getElementById("stepsnoexplain")){
                    document.getElementById("stepsnoexplain").style.display = 'flex'
                    }
                }
            })
            darkmode.addEventListener('change', function() {
                console.log('darkmode')
                if(this.checked) {
                    document.body.style.backgroundColor = '#aa88ee';
                    document.getElementById('playlink').style.color = '#aa88ee'
                document.getElementById('playlink').style.borderBottom = '2px #aa88ee solid'
                    if(document.body.style.backgroundColor === '#aa88ee'){
                        console.log('purple')
                    }
                    document.getElementById('difs').style.backgroundColor = '#fab072'
                    document.getElementById('rules').style.backgroundColor = '#fab072'
                    document.getElementById('buttons').style.backgroundColor = '#fab072'
                    if(document.getElementById('steps')){
                    document.getElementById('steps').style.backgroundColor = '#51cba4'
                    document.getElementById('stepsnoexplain').style.backgroundColor = '#51cba4'
                    }
                    var cookies = document.cookie.split(";");
                    for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i];
                    const eqPos = cookie.indexOf("=");
                    const name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
                    document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
                    console.log(document.cookie)
                    }
                    console.log(document.cookie)
                    document.cookie = "darkmode=true; max-age=3600"
                    console.log(document.cookie)
                    for(let i=0; i < 81; i++){
                        inputs[i].style.backgroundColor = 'black'
                        if(!(redsjs.includes(i) || bluesjs.includes(i) || graysjs.includes(i))){
                        inputs[i].style.color = 'white'
                        } else {
                        if(graysjs.includes(i)){
                        inputs[i].style.color = 'silver'
                        }
                        }
                    }
                } else {
                    document.body.style.backgroundColor = '#fa8072';
                    document.getElementById('difs').style.backgroundColor = 'rgb(138, 202, 242)'
                    document.getElementById('playlink').style.color = '#fa8072'
                    document.getElementById('playlink').style.borderBottom = '2px #fa8072 solid'
                    document.getElementById('rules').style.backgroundColor = '#eee089'
                    document.getElementById('buttons').style.backgroundColor = 'rgb(138, 202, 242)'
                    if(document.getElementById('steps')){
                    document.getElementById('steps').style.backgroundColor = '#eee089'
                    document.getElementById('stepsnoexplain').style.backgroundColor = '#eee089'
                    }
                    
                    var cookies = document.cookie.split(";");
                    for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i];
                    const eqPos = cookie.indexOf("=");
                    const name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
                    document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
                    }
                    document.cookie = "darkmode=false; max-age=3600"
                    console.log(document.cookie)
                    for(let i=0; i < 81; i++){
                        inputs[i].style.backgroundColor = 'white'
                        if(!(redsjs.includes(i) || bluesjs.includes(i) || graysjs.includes(i))){
                        inputs[i].style.color = 'black'
                        
                        } else {
                        if(graysjs.includes(i)){
                        inputs[i].style.color = 'gray'
                        }
                        }
                    }
                }

            })
            checkbox.addEventListener("change", function() {
            if (this.checked) {
            console.log("Checkbox is checked");
            for(let i=0; i < cells.length; i++){
                if(!(graysjs.includes(i) || bluesjs.includes(i) || cells[i].value != "")) {
                
                cells[i].style.fontSize = '0.7em'
                cells[i].style.textAlign = 'left'
                if(cells[i].name[0] !== '#'){
                cells[i].name = '#' + cells[i].name
                }
                cells[i].style.color = 'black'
                if(darkmode.checked){
                    cells[i].style.color = 'white'
                }
            }
            }
            } else {
            console.log("Checkbox is not checked");
            for(let i=0; i < cells.length; i++){
            if(!(graysjs.includes(i) || bluesjs.includes(i) || cells[i].value != "")) {
            cells[i].style.fontSize = '1.3em'
            cells[i].style.textAlign = 'center'
            if(cells[i].name[0] === "#"){
                cells[i].name = cells[i].name.substring(1)
            }
            console.log(cells[i].name)
            cells[i].style.color = 'black'
                if(darkmode.checked){
                    cells[i].style.color = 'white'
                }
            }
            }
            }
            });
        </script>
         <script>
            let redsjs = {{ reds }}
            let bluesjs = {{ blues }}
            let graysjs = {{ grays }}
            let numsjs = {{ nums }}
            let smallsjs = {{ s }}
            let sol = {{ solution }}
            let difficulty = "{{ dif }}"
            var width = window.innerWidth;
            var darkmode = document.getElementById('darkmode')
            const changeEvent = new Event('change');
            const letters = ["A", "B", "C", "D", "E", "F", "G", "H", "I"]
            let currentInputIndex = 0;
            console.log(difficulty)
            if(difficulty !== 'none'){
            document.getElementById(difficulty).classList.add('greendif')
            }
            document.body.style.backgroundColor = '#fa8072';
            document.getElementById('playlink').style.color = '#fa8072'
            document.getElementById('playlink').style.borderBottom = '2px #fa8072 solid'
              // Get all the text inputs in the document
            if(document.cookie){
                var cookies = document.cookie.split(';');
                var dark = 'false'
                var dcheck  = 0
            // Loop through the cookies to find the one with the specified name
            for(var i = 0; i < cookies.length; i++) {
                if(dcheck === 0){
                var cookie = cookies[i].trim();
                // Check if this cookie has the desired name
                if(cookie.indexOf('darkmode') === 0) {
                // Return the value of the cookie
                var dark = cookie.substring(9, cookie.length);
                console.log(dark)
                dcheck = 1
                }
            }
            }
            if(dark === 'true'){
                darkmode.checked = true
                darkmode.dispatchEvent(changeEvent);
                document.body.style.backgroundColor = '#aa88ee';
                document.getElementById('playlink').style.color = '#aa88ee'
                document.getElementById('playlink').style.borderBottom = '2px #aa88ee solid'
            for (let i=0; i < 81; i++){
                inputs[i].style.backgroundColor = 'black'
                if(!(redsjs.includes(i) || bluesjs.includes(i) || graysjs.includes(i))){
                inputs[i].style.color = 'white'
                } else {
                if(graysjs.includes(i)){
                inputs[i].style.color = 'silver'
                }
                }
            }
        }
    }
              var cells = document.getElementsByClassName('searchbar')
              for (let i=0; i < 81; i++){
                inputs[i].addEventListener('click', function(){
                    solvecell.value = "Solve cell";
                    for(let j=0; j<81;j++){
                        if(darkmode.checked){
                        inputs[j].style.backgroundColor = 'black'
                        } else {
                        inputs[j].style.backgroundColor = 'white'
                        }
                    }
                    if(darkmode.checked){
                        this.style.backgroundColor = '#aa88ee'
                    } else {
                    this.style.backgroundColor = 'cornflowerblue'
                    }
                    var letter = this.id[0]
                    var number = parseInt(this.id[1])
                    for(let j=0; j < 9; j++){
                        if(letter === letters[j]){
                            currentInputIndex = 9 * j
                        }
                    }
                    currentInputIndex = currentInputIndex + number - 1
                    console.log(currentInputIndex)
                }

                )
              }

// Add an event listener to detect key presses
document.addEventListener("keydown", function(event) {
    const checkbox = document.getElementById('togglecandidates');
    const autocheck = document.getElementById('autocheck')
    const darkmode = document.getElementById('darkmode')
  switch (event.key) {
    case 'n':
      // Get the checkbox element
      event.preventDefault()
      checkbox.checked = !checkbox.checked
      // Toggle the checked state of the checkbox
    checkbox.dispatchEvent(changeEvent);
      break;
    case 'a':
        event.preventDefault()
        autocheck.checked = !autocheck.checked
    autocheck.dispatchEvent(changeEvent);
        break;
    case 'N':
    // Get the checkbox element
    // Toggle the checked state of the checkbox
    event.preventDefault()
    checkbox.checked = !checkbox.checked
    checkbox.dispatchEvent(changeEvent);
    break;
    case 'A':
    event.preventDefault()
    autocheck.checked = !autocheck.checked
    autocheck.dispatchEvent(changeEvent);
        break;
    case 'd':
    event.preventDefault()
    console.log('d')
    darkmode.checked = !darkmode.checked
    darkmode.dispatchEvent(changeEvent);
        break;
    case 'D':
    event.preventDefault()
    console.log('D')
    darkmode.checked = !darkmode.checked
    darkmode.dispatchEvent(changeEvent);
        break;
    case 'E':
    event.preventDefault()
    console.log('E')
    explains.checked = !explains.checked
    explains.dispatchEvent(changeEvent);
    break;
    case 'e':
    event.preventDefault()
    console.log('e')
    explains.checked = !explains.checked
    explains.dispatchEvent(changeEvent);
    break;
    case "ArrowLeft":
      // Left arrow key pressed
      if (currentInputIndex > 0) {
        currentInputIndex--;
        console.log(currentInputIndex)
        inputs[currentInputIndex].focus();
        for(let j=0; j<81;j++){
        if(darkmode.checked){
        inputs[j].style.backgroundColor = 'black'
        } else {
        inputs[j].style.backgroundColor = 'white'
        }
    }
        if(darkmode.checked){
            inputs[currentInputIndex].style.backgroundColor = '#aa88ee'
        } else {
        inputs[currentInputIndex].style.backgroundColor = 'cornflowerblue'
        }
        if(!(graysjs.includes(currentInputIndex) || bluesjs.includes(currentInputIndex))){
        if(checkbox.checked) {
            if(inputs[currentInputIndex].value === ""){
            inputs[currentInputIndex].style.fontSize = '0.7em'
            inputs[currentInputIndex].style.textAlign = 'left'
            console.log('checked')
            if(inputs[currentInputIndex].name[0] !== '#'){
            inputs[currentInputIndex].name = '#' + cells[currentInputIndex].name
            }
        }
        } else{
            inputs[currentInputIndex].style.fontSize = '1.3em'
            inputs[currentInputIndex].style.textAlign = 'center'
            if(inputs[currentInputIndex].value.length > 1){
                inputs[currentInputIndex].value = ''
            }
            if(redsjs.includes(currentInputIndex)){
                inputs[currentInputIndex].value = ''
                if(darkmode.checked){
                inputs[currentInputIndex].style.color = 'white'
                } else {
                inputs[currentInputIndex].style.color = 'black'
                }
                redsjs = redsjs.filter(function(element) {
                return element !== currentInputIndex;
                });
            }
            if(inputs[currentInputIndex].name[0] === '#'){
                inputs[currentInputIndex].name = inputs[currentInputIndex].name.substring(1)
                }
            console.log('not checked')
        }
    }
      }
      break;
    case "ArrowUp":
      // Up arrow key pressed
      if(currentInputIndex > 8) {
        currentInputIndex = currentInputIndex - 9;
        inputs[currentInputIndex].focus();
        for(let j=0; j<81;j++){
        if(darkmode.checked){
        inputs[j].style.backgroundColor = 'black'
        
        } else {
        inputs[j].style.backgroundColor = 'white'
        
        }
    }
    if(darkmode.checked){
            inputs[currentInputIndex].style.backgroundColor = '#aa88ee'
        } else {
        inputs[currentInputIndex].style.backgroundColor = 'cornflowerblue'
        }
        if(!(graysjs.includes(currentInputIndex) || bluesjs.includes(currentInputIndex))){
        if(checkbox.checked) {
            if(inputs[currentInputIndex].value === ""){
            inputs[currentInputIndex].style.fontSize = '0.7em'
            inputs[currentInputIndex].style.textAlign = 'left'
            console.log('checked')
            if(inputs[currentInputIndex].name[0] !== '#'){
            inputs[currentInputIndex].name = '#' + cells[currentInputIndex].name
            }
        }
        } else{
            inputs[currentInputIndex].style.fontSize = '1.3em'
            inputs[currentInputIndex].style.textAlign = 'center'
            if(inputs[currentInputIndex].value.length > 1){
                inputs[currentInputIndex].value = ''
            }
            if(redsjs.includes(currentInputIndex)){
                inputs[currentInputIndex].value = ''
                if(darkmode.checked){
                inputs[currentInputIndex].style.color = 'white'
                } else {
                inputs[currentInputIndex].style.color = 'black'
                }
                redsjs = redsjs.filter(function(element) {
                return element !== currentInputIndex;
                });
            }
            if(inputs[currentInputIndex].name[0] === '#'){
                inputs[currentInputIndex].name = inputs[currentInputIndex].name.substring(1)
                }
            console.log('not checked')
        }
    }
      }
      break;
    case "ArrowRight":
      // Right arrow key pressed
      if (currentInputIndex < 80) {
        currentInputIndex++;
        inputs[currentInputIndex].focus();
        for(let j=0; j<81;j++){
        if(darkmode.checked){
        inputs[j].style.backgroundColor = 'black'
        
        } else {
        inputs[j].style.backgroundColor = 'white'
        
        }
    }
    if(darkmode.checked){
            inputs[currentInputIndex].style.backgroundColor = '#aa88ee'
        } else {
        inputs[currentInputIndex].style.backgroundColor = 'cornflowerblue'
        }
        if(!(graysjs.includes(currentInputIndex) || bluesjs.includes(currentInputIndex))){
        if(checkbox.checked) {
            if(inputs[currentInputIndex].value === ""){
            inputs[currentInputIndex].style.fontSize = '0.7em'
            inputs[currentInputIndex].style.textAlign = 'left'
            console.log('checked')
            if(inputs[currentInputIndex].name[0] !== '#'){
            inputs[currentInputIndex].name = '#' + cells[currentInputIndex].name
            }
        }
        } else{
            inputs[currentInputIndex].style.fontSize = '1.3em'
            inputs[currentInputIndex].style.textAlign = 'center'
            if(inputs[currentInputIndex].value.length > 1){
                inputs[currentInputIndex].value = ''
            }
            if(redsjs.includes(currentInputIndex)){
                inputs[currentInputIndex].value = ''
                if(darkmode.checked){
                inputs[currentInputIndex].style.color = 'white'
                } else {
                inputs[currentInputIndex].style.color = 'black'
                }
                redsjs = redsjs.filter(function(element) {
                return element !== currentInputIndex;
                });
            }
            if(inputs[currentInputIndex].name[0] === '#'){
                inputs[currentInputIndex].name = inputs[currentInputIndex].name.substring(1)
                }
            console.log('not checked')
        }
    }
      }
      break;
    case "ArrowDown":
      // Down arrow key pressed
      if(currentInputIndex < 72){
        currentInputIndex = currentInputIndex + 9;
        inputs[currentInputIndex].focus();
        for(let j=0; j<81;j++){
        if(darkmode.checked){
        inputs[j].style.backgroundColor = 'black'
        
        } else {
        inputs[j].style.backgroundColor = 'white'
        
        }
    }
    if(darkmode.checked){
        inputs[currentInputIndex].style.backgroundColor = '#aa88ee'
        } else {
        inputs[currentInputIndex].style.backgroundColor = 'cornflowerblue'
        }
        if(!(graysjs.includes(currentInputIndex) || bluesjs.includes(currentInputIndex))){
        if(checkbox.checked) {
            if(inputs[currentInputIndex].value === ""){
            inputs[currentInputIndex].style.fontSize = '0.7em'
            inputs[currentInputIndex].style.textAlign = 'left'
            console.log('checked')
            if(inputs[currentInputIndex].name[0] !== '#'){
            inputs[currentInputIndex].name = '#' + cells[currentInputIndex].name
            }
        }
        } else{
            inputs[currentInputIndex].style.fontSize = '1.3em'
            inputs[currentInputIndex].style.textAlign = 'center'
            if(inputs[currentInputIndex].value.length > 1){
                inputs[currentInputIndex].value = ''
            }
            if(redsjs.includes(currentInputIndex)){
                inputs[currentInputIndex].value = ''
                if(darkmode.checked){
                inputs[currentInputIndex].style.color = 'white'
                } else {
                inputs[currentInputIndex].style.color = 'black'
                }
                redsjs = redsjs.filter(function(element) {
                return element !== currentInputIndex;
                });
            }
            if(inputs[currentInputIndex].name[0] === '#'){
                inputs[currentInputIndex].name = inputs[currentInputIndex].name.substring(1)
                }
            console.log('not checked')
        }
    }
      }
      break;
    default:
      break;
  }
});
            for (let i=0; i < 81; i++){
                let j = i%9 + 1
                if(redsjs.includes(i)){
                document.getElementById(letters[Math.floor(i/9)] + j.toString()).style.color = "red"
                document.getElementById(letters[Math.floor(i/9)] + j.toString()).value = numsjs[i]
                document.getElementById(letters[Math.floor(i/9)] + j.toString()).style.fontSize = '1.3em'
                }
                if(bluesjs.includes(i)){
                    document.getElementById(letters[Math.floor(i/9)] + j.toString()).style.color = "blue"
                    document.getElementById(letters[Math.floor(i/9)] +j.toString()).value = numsjs[i]
                    document.getElementById(letters[Math.floor(i/9)] + j.toString()).style.fontSize = '1.3em'
                    document.getElementById(letters[Math.floor(i/9)] + j.toString()).readOnly = 'true'
                    }
                    if(graysjs.includes(i)){
                        if(darkmode.checked){
                        document.getElementById(letters[Math.floor(i/9)] + j.toString()).style.color = "silver"
                        } else {
                        document.getElementById(letters[Math.floor(i/9)] + j.toString()).style.color = "gray"
                        }
                        document.getElementById(letters[Math.floor(i/9)] + j.toString()).value = numsjs[i]
                        document.getElementById(letters[Math.floor(i/9)] + j.toString()).style.fontSize = '1.3em'
                        document.getElementById(letters[Math.floor(i/9)] + j.toString()).readOnly = 'true'
                        }
                    if(smallsjs.includes(i)){
                        if(darkmode.checked){
                            document.getElementById(letters[Math.floor(i/9)] + j.toString()).style.color = "white"
                        } else {
                        document.getElementById(letters[Math.floor(i/9)] + j.toString()).style.color = "black"
                        }
                        document.getElementById(letters[Math.floor(i/9)] + j.toString()).value = numsjs[i]
                        document.getElementById(letters[Math.floor(i/9)] + j.toString()).style.fontSize = '0.7em'
                        document.getElementById(letters[Math.floor(i/9)] + j.toString()).style.textAlign = 'left'
                        document.getElementById(letters[Math.floor(i/9)] + j.toString()).name = '#' + document.getElementById(letters[Math.floor(i/9)] + j.toString()).name
                        console.log(document.getElementById(letters[Math.floor(i/9)] + j.toString()).name)
                    }
            }
            </script>
            <script>
                explains.checked = true
                explains.dispatchEvent(changeEvent);
                var cells = document.getElementsByClassName('searchbar')
                var checkbox = document.getElementById("togglecandidates");
                for(let i=0; i < cells.length; i++){
                    cells[i].addEventListener('click', function() {
                        if(!(graysjs.includes(i) || bluesjs.includes(i))){
                        if(checkbox.checked) {
                            console.log(this.id)
                            this.style.fontSize = '0.7em'
                            this.style.textAlign = 'left'
                            console.log('checked')
                            if(darkmode.checked){
                                this.style.color = 'white'
                            } else {
                            this.style.color = 'black'
                            }
                            if(this.name[0] !== '#'){
                            this.name = '#' + cells[i].name
                            }
                        } else{
                            this.style.fontSize = '1.3em'
                            this.style.textAlign = 'center'
                            this.value = ""
                            if(darkmode.checked){
                                this.style.color = 'white'
                            } else {
                            this.style.color = 'black'
                            }
                            if(this.name[0] === '#'){
                                this.name = this.name.substring(1)
                                }
                            console.log('not checked')
                        }
                    }
                    })
                 }
            </script>
    {% endblock %}
</body>